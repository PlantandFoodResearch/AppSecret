---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

[![Travis build status](https://travis-ci.org/PlantandFoodResearch/AppSecret.svg?branch=master)](https://travis-ci.org/PlantandFoodResearch/AppSecret)
[![Coverage status](https://coveralls.io/repos/github/PlantandFoodResearch/AppSecret/badge.svg)](https://coveralls.io/r/PlantandFoodResearch/AppSecret?branch=master)

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
# AppSecret

The goal of AppSecret is to manage application secrets for users, be they developers or test/production service users.

## Installation

AppSecret is not on CRAN. It is a private repository so create and expose `GITHUB_PAT` appropriately.

``` r
devtools::install_github("PlantandFoodResearch/AppSecret")
```

#### GITHUB_PAT

from `?devtools::install_github`

```
# To install from a private repo, use auth_token with a token
# from https://github.com/settings/tokens. You only need the
# repo scope. Best practice is to save your PAT in env var called
# GITHUB_PAT.
install_github("hadley/private", auth_token = "abc")
```

## Example

This is a basic example which shows you how to solve a common problem:

```{r create-a-secret}
library(here)
library(AppSecret)

password_file <- file.path(here(), ".user-settings", Sys.getenv("USER"), "password")

asm <- app_secret_manager(symmetric_file = file.path(here(), ".user-settings", Sys.getenv("USER"), "symmetric.rsa"),
                          key_file       = file.path(Sys.getenv("HOME"), ".app-name", "application-secrets.pem"))

encrypted <- asm$encrypt_data("this is my password")

asm$write_encrypted(data = encrypted, file = password_file)

file.exists(password_file)

asm$read_encrypted(password_file)
```

Somewhere in your application

```{r application-code}
library(here)
library(AppSecret)

password_file <- file.path(here(), ".user-settings", Sys.getenv("USER"), "password")

asm <- app_secret_manager(symmetric_file = file.path(here(), ".user-settings", Sys.getenv("USER"), "symmetric.rsa"),
                          key_file       = file.path(Sys.getenv("HOME"), ".app-name", "application-secrets.pem"))

password <- asm$decrypt_file(password_file)
password
```

